Excel File Comparison Script

Introduction:
This Python script compares two Excel files and outputs the comparison results into 4 different sheets.

Features:
Compares columns between two Excel files

Generates 4 different output sheets

Identifies common and different rows

Provides error reports and differences

Required Libraries:
pip install pandas openpyxl

File Structure:
project/
├── compare_excel.py    # Main script
├── file1.xlsx         # First Excel file
├── file2.xlsx         # Second Excel file
└── comparison_result.xlsx        # Output file (generated by script)

------
Usage
------

Running the Script:
python compare_excel.py

Input Parameters
The script uses the following files by default:

First file: file1.xlsx

Second file: file2.xlsx

Output file: comparison_result.xlsx

To change these files, modify the script accordingly.


----------------------
Customization Options
----------------------

1.Changing Input/Output Files:

# Lines 7-8 - Change input file paths
file1 = pd.read_excel('file1.xlsx', header=None)
file2 = pd.read_excel('file2.xlsx', header=None)

# Line 65 - Change output file name
output_file = 'comparison_result.xlsx'



2.Modifying Sorting Columns:

# Lines 21-24 - Change sorting columns
sort_cols_1 = [headers_1[0], headers_1[7], headers_1[6]]  # First, eighth, and seventh columns
sort_cols_2 = [headers_2[0], headers_2[7], headers_2[6]]  # First, eighth, and seventh columns


3.Changing Comparison Keys:

# Lines 27-34 - Modify comparison keys
# Currently uses three keys for comparison:
# - First column (index 0): Primary key
# - Third column (index 2): Secondary key
# - Seventh column (index 6): Tertiary key

key_column_name_1 = headers_1[0]  # First column of first file
key_column_name_2 = headers_2[0]  # First column of second file
compare_column_name_1 = headers_1[2]  # Third column of first file
compare_column_name_2 = headers_2[2]  # Third column of second file
compare_column_name_7_1 = headers_1[6]  # Seventh column of first file
compare_column_name_7_2 = headers_2[6]  # Seventh column of second file


4.Modifying Formatting Settings:

# Line 72 - Change highlight color for specific rows
orange_fill = PatternFill(start_color="FFA500", end_color="FFA500", fill_type="solid")  # Orange color

# Lines 82-88 - Change coloring condition (empty column H)
cell_h = ws.cell(row=i, column=8)  # Column H
if cell_h.value is None or str(cell_h.value).strip() == '':
    # Column 8 empty → Color entire row orange
    for col in range(1, ws.max_column + 1):
        ws.cell(row=i, column=col).fill = orange_fill
        
        
--------------
Output Sheets
-------------- 
(Common - File 1): Rows common to both files (from File 1)

(Common - File 2): Rows common to both files (from File 2)

(Only in File 1): Rows present only in the first file

(Only in File 2): Rows present only in the second file


------
Notes
------
Ensure both files have the same column structure

Input files should be in the same directory as the script

The output file will be created or overwritten automatically


------------------
Technical Details
------------------
The script performs the following operations:

Reads Excel files without considering the first row as headers

Uses the first row as column names

Sorts data based on the first, eighth, and seventh columns

Compares rows based on the first, third, and seventh columns

Applies formatting (right alignment, RTL direction, and color coding) to the output


----------------
Troubleshooting
----------------
If you encounter errors:

Verify that input files exist

Ensure Excel files are in the correct format

Check that required libraries are installed

